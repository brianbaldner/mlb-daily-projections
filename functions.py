import io
import pandas as pd
import requests


session = requests.Session()

session.headers = {
  'Referer': 'https://baseballsavant.mlb.com/statcast_search?hfPT=&hfAB=&hfGT=R%7C&hfPR=&hfZ=&hfStadium=&hfBBL=&hfNewZones=&hfPull=&hfC=&hfSea=2025%7C2024%7C&hfSit=&player_type=pitcher&hfOuts=&hfOpponent=&pitcher_throws=&batter_stands=&hfSA=&game_date_gt=&game_date_lt=&hfMo=&hfTeam=&home_road=&hfRO=&position=&hfInfield=&hfOutfield=&hfInn=&hfBBT=&batters_lookup%5B%5D=665487&hfFlag=&metric_1=&group_by=team-pitch-type&min_pitches=0&min_results=0&min_pas=0&sort_col=pitches&player_event_sort=api_p_release_speed&sort_order=desc&chk_stats_hits=on&chk_stats_singles=on&chk_stats_dbls=on&chk_stats_triples=on&chk_stats_hrs=on',
  'Upgrade-Insecure-Requests': '1',
  'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36 Edg/135.0.0.0',
  'sec-ch-ua': '"Microsoft Edge";v="135", "Not-A.Brand";v="8", "Chromium";v="135"',
  'sec-ch-ua-mobile': '?0',
  'sec-ch-ua-platform': '"Windows"',
  'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7',
  'accept-language': 'en-US,en;q=0.9',
  'cache-control': 'no-cache',
  'pragma': 'no-cache',
  'priority': 'u=0, i',
  'referer': 'https://baseballsavant.mlb.com/statcast_search?hfPT=&hfAB=&hfGT=R%7C&hfPR=&hfZ=&hfStadium=&hfBBL=&hfNewZones=&hfPull=&hfC=&hfSea=2025%7C2024%7C&hfSit=&player_type=pitcher&hfOuts=&hfOpponent=&pitcher_throws=&batter_stands=&hfSA=&game_date_gt=&game_date_lt=&hfMo=&hfTeam=&home_road=&hfRO=&position=&hfInfield=&hfOutfield=&hfInn=&hfBBT=&batters_lookup%5B%5D=665487&hfFlag=&metric_1=&group_by=team-pitch-type&min_pitches=0&min_results=0&min_pas=0&sort_col=pitches&player_event_sort=api_p_release_speed&sort_order=desc&chk_stats_hits=on&chk_stats_singles=on&chk_stats_dbls=on&chk_stats_triples=on&chk_stats_hrs=on',
  'sec-fetch-dest': 'document',
  'sec-fetch-mode': 'navigate',
  'sec-fetch-site': 'same-origin',
  'sec-fetch-user': '?1',
  'Accept-Encoding': 'gzip',
  'upgrade-insecure-requests': '1',
  'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36 Edg/135.0.0.0',
  'Cookie': 's_ecid=MCMID%7C01047893621908779112685024282806422538; pbjs_sharedId=9dfcbc48-28b3-4b1c-b2d1-27b8e1b6dcb2; _lc2_fpi=ca79ac0ed495--01jqy7qjtf83b15kqceqr1n9e6; _lc2_fpi_meta=%7B%22w%22%3A1743697726287%7D; s_vi=[CS]v1|33F75B9F77F49534-400007FF81B0F3E4[CE]; _cb=Ohsg9BuV8DdBwkzHN; _scid=FwdPZsywQ4FHSiDhvs3KefecC-DGmPMPebXXuQ; _fbp=fb.1.1744052866017.135089481768840074; _tt_enable_cookie=1; _ttp=01JR8TDK1Z630QZNJ02CWDX4T4_.tt.1; OptanonAlertBoxClosed=2025-04-07T19:07:54.345Z; adcloud={%22_les_v%22:%22c%2Cy%2Cmlb.com%2C1744231465%22}; ttcsid_CC3QKFJC77U295EGILK0=1744229666050.1.1744229666442; _sharedid=2f2175ef-28ca-4ba3-867d-7d952d62cb0a; _sharedid_cst=zix7LPQsHA%3D%3D; _v__chartbeat3=CBApVfCSXdQWDxyGJo; AAMC_mlb_0=REGION%7C9; aam_uuid=00764976251229479512682052088493788082; _ScCbts=%5B%5D; _sctr=1%7C1744786800000; _gcl_au=1.1.1117725333.1744052867.294600536.1744834333.1744834338; oktaid=00uardyuasa9Ez2GT357; s_campaign_stack=%5B%5B%27LR_preview%27%2C%271744054889735%27%5D%2C%5B%27LR_preview%27%2C%271744054889744%27%5D%2C%5B%27LR_preview%27%2C%271744054911815%27%5D%2C%5B%27LR_preview%27%2C%271744054934596%27%5D%2C%5B%27LR_preview%27%2C%271744054941932%27%5D%2C%5B%27LR_preview%27%2C%271744054941956%27%5D%2C%5B%27LR_preview%27%2C%271744054941970%27%5D%2C%5B%27LR_preview%27%2C%271744054945871%27%5D%2C%5B%27LR_preview%27%2C%271744054945889%27%5D%2C%5B%27LR_preview%27%2C%271744054948698%27%5D%2C%5B%27LR_video%27%2C%271744834326849%27%5D%2C%5B%27LR_video%27%2C%271744834340546%27%5D%2C%5B%27LR_video%27%2C%271744834347937%27%5D%5D; connectId=%7B%22vmuid%22%3A%221OvYLJhFMvnJQ4qBwQVOm1QRMfsYq1YhjflpVbbBDFJqL85SdMLYYP-dJP6t7PRoB7leyqKO5s6VvRvy7y-pQQ%22%2C%22connectid%22%3A%221OvYLJhFMvnJQ4qBwQVOm1QRMfsYq1YhjflpVbbBDFJqL85SdMLYYP-dJP6t7PRoB7leyqKO5s6VvRvy7y-pQQ%22%2C%22connectId%22%3A%221OvYLJhFMvnJQ4qBwQVOm1QRMfsYq1YhjflpVbbBDFJqL85SdMLYYP-dJP6t7PRoB7leyqKO5s6VvRvy7y-pQQ%22%2C%22ttl%22%3A86400000%2C%22he%22%3A%22877a1817ab88a30cfc9c418e61333d44bbd765d85538573a47e58b09129e791b%22%2C%22lastSynced%22%3A1744834432345%2C%22lastUsed%22%3A1744834432345%7D; pbjs_sharedId_cst=VyxHLMwsHQ%3D%3D; _ga_FVSDNMVW46=GS1.2.1744834366.1.1.1744834719.59.0.0; __cflb=02DiuJFcgbX2zpcHdRusb7zVwg8RFD7sBirXqMh1W3gBe; _chartbeat2=.1730832657048.1745345088258.1000100000000001.BqTgZLB94n-zD9nPB3_IChcZLGbq.1; minUnifiedSessionToken10=%7B%22sessionId%22%3A%222b763fe0ad-50aa79616c-1dd3ff6a36-4caedb779e-25173818f3%22%2C%22uid%22%3A%22f1b7df8e92-3668ac3c52-fb8cef5330-fa2c063894-c31a5d8438%22%2C%22__sidts__%22%3A1745345088346%2C%22__uidts__%22%3A1745345088346%7D; _gid=GA1.2.774545763.1745345089; kndctr_A65F776A5245B01B0A490D44_AdobeOrg_identity=CiYwMTA0Nzg5MzYyMTkwODc3OTExMjY4NTAyNDI4MjgwNjQyMjUzOFIQCKOM7%2DPfMhgBKgNPUjIwA%5FAB%2DPGx9eUy; mbox=session#2ae28d6b55274f6ead247e995bf0fbba#1745346943|PC#afa588117f754338908d74c9606983e4.35_0#1808591703; _ga_N8YFCZLYSZ=GS1.1.1745346903.8.0.1745346903.60.0.205013699; _ga=GA1.2.2011063467.1744052867; _scid_r=HQdPZsywQ4FHSiDhvs3KefecC-DGmPMPebXX3Q; OptanonConsent=isGpcEnabled=0&datestamp=Tue+Apr+22+2025+11%3A35%3A03+GMT-0700+(Pacific+Daylight+Time)&version=202502.1.0&browserGpcFlag=0&isIABGlobal=false&hosts=&consentId=cb86474f-f174-4842-b601-b60b49f84ce1&interactionCount=1&isAnonUser=1&landingPath=NotLandingPage&groups=C0001%3A1%2CC0003%3A1%2CC0002%3A1%2CC0004%3A1&intType=3&geolocation=US%3BOR&AwaitingReconsent=false; _uetsid=47eb06901fa411f0b2592b094ae57f65; _uetvid=e4cd86809ba611ef903223ae709ab1c0; s_getNewRepeat=1745346943650-Repeat; s_lv=1745346943651; ttcsid_CPGTP6JC77U5SPBHH95G=1745346903787::rfaKXWZ7MOlAjGQ5GkKE.5.1745346943844; ttcsid_CBM13CRC77U963VPQL9G=1745346903948::xaVx6O2yGYfdcZn7P1JF.5.1745346943848; ttcsid_CUR2STRC77U4QKJNGKOG=1745346904000::fspMxsOgnGgbYADDeiez.5.1745346943852; ttcsid=1745346903787::fMC-I_NVUF90_WVQgR8t.5.1745346943853; AMCV_A65F776A5245B01B0A490D44%40AdobeOrg=1099438348%7CMCIDTS%7C20201%7CMCMID%7C01047893621908779112685024282806422538%7CMCAAMLH-1745951891%7C9%7CMCAAMB-1745951891%7C6G1ynYcLPuiQxYZrsz_pkqfLG9yMXBpb2zX5dvJdYQJzPXImdj0y%7CMCOPTOUT-1745354291s%7CNONE%7CMCAID%7CNONE%7CMCSYNCSOP%7C411-20197%7CvVersion%7C2.1.0; __gads=ID=a1a63c2b08cf72c0:T=1739839528:RT=1745347240:S=ALNI_Mb_S9DHPzGZbymcO8fr1YaL9So7Zw; __gpi=UID=0000104efefab578:T=1739839528:RT=1745347240:S=ALNI_MZLv3zsBnvXDr48gLk0zXT2IxY_Hg; __eoi=ID=960ec4c20fca01a6:T=1739839528:RT=1745347240:S=AA-AfjZs3iY0cg-QABdzW-WQaqo9; s_cc=true; s_sq=%5B%5BB%5D%5D; _dd_s=rum=0&expire=1745351455210',
  'Cookie': 's_ecid=MCMID%7C01047893621908779112685024282806422538; pbjs_sharedId=9dfcbc48-28b3-4b1c-b2d1-27b8e1b6dcb2; _lc2_fpi=ca79ac0ed495--01jqy7qjtf83b15kqceqr1n9e6; _lc2_fpi_meta=%7B%22w%22%3A1743697726287%7D; s_vi=[CS]v1|33F75B9F77F49534-400007FF81B0F3E4[CE]; _cb=Ohsg9BuV8DdBwkzHN; _scid=FwdPZsywQ4FHSiDhvs3KefecC-DGmPMPebXXuQ; _fbp=fb.1.1744052866017.135089481768840074; _tt_enable_cookie=1; _ttp=01JR8TDK1Z630QZNJ02CWDX4T4_.tt.1; OptanonAlertBoxClosed=2025-04-07T19:07:54.345Z; adcloud={%22_les_v%22:%22c%2Cy%2Cmlb.com%2C1744231465%22}; ttcsid_CC3QKFJC77U295EGILK0=1744229666050.1.1744229666442; _sharedid=2f2175ef-28ca-4ba3-867d-7d952d62cb0a; _sharedid_cst=zix7LPQsHA%3D%3D; _v__chartbeat3=CBApVfCSXdQWDxyGJo; AAMC_mlb_0=REGION%7C9; aam_uuid=00764976251229479512682052088493788082; _ScCbts=%5B%5D; _sctr=1%7C1744786800000; _gcl_au=1.1.1117725333.1744052867.294600536.1744834333.1744834338; oktaid=00uardyuasa9Ez2GT357; s_campaign_stack=%5B%5B%27LR_preview%27%2C%271744054889735%27%5D%2C%5B%27LR_preview%27%2C%271744054889744%27%5D%2C%5B%27LR_preview%27%2C%271744054911815%27%5D%2C%5B%27LR_preview%27%2C%271744054934596%27%5D%2C%5B%27LR_preview%27%2C%271744054941932%27%5D%2C%5B%27LR_preview%27%2C%271744054941956%27%5D%2C%5B%27LR_preview%27%2C%271744054941970%27%5D%2C%5B%27LR_preview%27%2C%271744054945871%27%5D%2C%5B%27LR_preview%27%2C%271744054945889%27%5D%2C%5B%27LR_preview%27%2C%271744054948698%27%5D%2C%5B%27LR_video%27%2C%271744834326849%27%5D%2C%5B%27LR_video%27%2C%271744834340546%27%5D%2C%5B%27LR_video%27%2C%271744834347937%27%5D%5D; connectId=%7B%22vmuid%22%3A%221OvYLJhFMvnJQ4qBwQVOm1QRMfsYq1YhjflpVbbBDFJqL85SdMLYYP-dJP6t7PRoB7leyqKO5s6VvRvy7y-pQQ%22%2C%22connectid%22%3A%221OvYLJhFMvnJQ4qBwQVOm1QRMfsYq1YhjflpVbbBDFJqL85SdMLYYP-dJP6t7PRoB7leyqKO5s6VvRvy7y-pQQ%22%2C%22connectId%22%3A%221OvYLJhFMvnJQ4qBwQVOm1QRMfsYq1YhjflpVbbBDFJqL85SdMLYYP-dJP6t7PRoB7leyqKO5s6VvRvy7y-pQQ%22%2C%22ttl%22%3A86400000%2C%22he%22%3A%22877a1817ab88a30cfc9c418e61333d44bbd765d85538573a47e58b09129e791b%22%2C%22lastSynced%22%3A1744834432345%2C%22lastUsed%22%3A1744834432345%7D; pbjs_sharedId_cst=VyxHLMwsHQ%3D%3D; _ga_FVSDNMVW46=GS1.2.1744834366.1.1.1744834719.59.0.0; __cflb=02DiuJFcgbX2zpcHdRusb7zVwg8RFD7sBirXqMh1W3gBe; _chartbeat2=.1730832657048.1745345088258.1000100000000001.BqTgZLB94n-zD9nPB3_IChcZLGbq.1; minUnifiedSessionToken10=%7B%22sessionId%22%3A%222b763fe0ad-50aa79616c-1dd3ff6a36-4caedb779e-25173818f3%22%2C%22uid%22%3A%22f1b7df8e92-3668ac3c52-fb8cef5330-fa2c063894-c31a5d8438%22%2C%22__sidts__%22%3A1745345088346%2C%22__uidts__%22%3A1745345088346%7D; _gid=GA1.2.774545763.1745345089; kndctr_A65F776A5245B01B0A490D44_AdobeOrg_identity=CiYwMTA0Nzg5MzYyMTkwODc3OTExMjY4NTAyNDI4MjgwNjQyMjUzOFIQCKOM7%2DPfMhgBKgNPUjIwA%5FAB%2DPGx9eUy; mbox=session#2ae28d6b55274f6ead247e995bf0fbba#1745346943|PC#afa588117f754338908d74c9606983e4.35_0#1808591703; _ga_N8YFCZLYSZ=GS1.1.1745346903.8.0.1745346903.60.0.205013699; _ga=GA1.2.2011063467.1744052867; _scid_r=HQdPZsywQ4FHSiDhvs3KefecC-DGmPMPebXX3Q; OptanonConsent=isGpcEnabled=0&datestamp=Tue+Apr+22+2025+11%3A35%3A03+GMT-0700+(Pacific+Daylight+Time)&version=202502.1.0&browserGpcFlag=0&isIABGlobal=false&hosts=&consentId=cb86474f-f174-4842-b601-b60b49f84ce1&interactionCount=1&isAnonUser=1&landingPath=NotLandingPage&groups=C0001%3A1%2CC0003%3A1%2CC0002%3A1%2CC0004%3A1&intType=3&geolocation=US%3BOR&AwaitingReconsent=false; _uetsid=47eb06901fa411f0b2592b094ae57f65; _uetvid=e4cd86809ba611ef903223ae709ab1c0; s_getNewRepeat=1745346943650-Repeat; s_lv=1745346943651; ttcsid_CPGTP6JC77U5SPBHH95G=1745346903787::rfaKXWZ7MOlAjGQ5GkKE.5.1745346943844; ttcsid_CBM13CRC77U963VPQL9G=1745346903948::xaVx6O2yGYfdcZn7P1JF.5.1745346943848; ttcsid_CUR2STRC77U4QKJNGKOG=1745346904000::fspMxsOgnGgbYADDeiez.5.1745346943852; ttcsid=1745346903787::fMC-I_NVUF90_WVQgR8t.5.1745346943853; AMCV_A65F776A5245B01B0A490D44%40AdobeOrg=1099438348%7CMCIDTS%7C20201%7CMCMID%7C01047893621908779112685024282806422538%7CMCAAMLH-1745951891%7C9%7CMCAAMB-1745951891%7C6G1ynYcLPuiQxYZrsz_pkqfLG9yMXBpb2zX5dvJdYQJzPXImdj0y%7CMCOPTOUT-1745354291s%7CNONE%7CMCAID%7CNONE%7CMCSYNCSOP%7C411-20197%7CvVersion%7C2.1.0; __gads=ID=a1a63c2b08cf72c0:T=1739839528:RT=1745347240:S=ALNI_Mb_S9DHPzGZbymcO8fr1YaL9So7Zw; __gpi=UID=0000104efefab578:T=1739839528:RT=1745347240:S=ALNI_MZLv3zsBnvXDr48gLk0zXT2IxY_Hg; __eoi=ID=960ec4c20fca01a6:T=1739839528:RT=1745347240:S=AA-AfjZs3iY0cg-QABdzW-WQaqo9; s_cc=true; s_sq=%5B%5BB%5D%5D; _dd_s=rum=0&expire=1745351489353',
  'Cookie': 's_ecid=MCMID%7C01047893621908779112685024282806422538; pbjs_sharedId=9dfcbc48-28b3-4b1c-b2d1-27b8e1b6dcb2; _lc2_fpi=ca79ac0ed495--01jqy7qjtf83b15kqceqr1n9e6; _lc2_fpi_meta=%7B%22w%22%3A1743697726287%7D; s_vi=[CS]v1|33F75B9F77F49534-400007FF81B0F3E4[CE]; _cb=Ohsg9BuV8DdBwkzHN; _scid=FwdPZsywQ4FHSiDhvs3KefecC-DGmPMPebXXuQ; _fbp=fb.1.1744052866017.135089481768840074; _tt_enable_cookie=1; _ttp=01JR8TDK1Z630QZNJ02CWDX4T4_.tt.1; OptanonAlertBoxClosed=2025-04-07T19:07:54.345Z; adcloud={%22_les_v%22:%22c%2Cy%2Cmlb.com%2C1744231465%22}; ttcsid_CC3QKFJC77U295EGILK0=1744229666050.1.1744229666442; _sharedid=2f2175ef-28ca-4ba3-867d-7d952d62cb0a; _sharedid_cst=zix7LPQsHA%3D%3D; _v__chartbeat3=CBApVfCSXdQWDxyGJo; AAMC_mlb_0=REGION%7C9; aam_uuid=00764976251229479512682052088493788082; _ScCbts=%5B%5D; _sctr=1%7C1744786800000; _gcl_au=1.1.1117725333.1744052867.294600536.1744834333.1744834338; oktaid=00uardyuasa9Ez2GT357; s_campaign_stack=%5B%5B%27LR_preview%27%2C%271744054889735%27%5D%2C%5B%27LR_preview%27%2C%271744054889744%27%5D%2C%5B%27LR_preview%27%2C%271744054911815%27%5D%2C%5B%27LR_preview%27%2C%271744054934596%27%5D%2C%5B%27LR_preview%27%2C%271744054941932%27%5D%2C%5B%27LR_preview%27%2C%271744054941956%27%5D%2C%5B%27LR_preview%27%2C%271744054941970%27%5D%2C%5B%27LR_preview%27%2C%271744054945871%27%5D%2C%5B%27LR_preview%27%2C%271744054945889%27%5D%2C%5B%27LR_preview%27%2C%271744054948698%27%5D%2C%5B%27LR_video%27%2C%271744834326849%27%5D%2C%5B%27LR_video%27%2C%271744834340546%27%5D%2C%5B%27LR_video%27%2C%271744834347937%27%5D%5D; connectId=%7B%22vmuid%22%3A%221OvYLJhFMvnJQ4qBwQVOm1QRMfsYq1YhjflpVbbBDFJqL85SdMLYYP-dJP6t7PRoB7leyqKO5s6VvRvy7y-pQQ%22%2C%22connectid%22%3A%221OvYLJhFMvnJQ4qBwQVOm1QRMfsYq1YhjflpVbbBDFJqL85SdMLYYP-dJP6t7PRoB7leyqKO5s6VvRvy7y-pQQ%22%2C%22connectId%22%3A%221OvYLJhFMvnJQ4qBwQVOm1QRMfsYq1YhjflpVbbBDFJqL85SdMLYYP-dJP6t7PRoB7leyqKO5s6VvRvy7y-pQQ%22%2C%22ttl%22%3A86400000%2C%22he%22%3A%22877a1817ab88a30cfc9c418e61333d44bbd765d85538573a47e58b09129e791b%22%2C%22lastSynced%22%3A1744834432345%2C%22lastUsed%22%3A1744834432345%7D; pbjs_sharedId_cst=VyxHLMwsHQ%3D%3D; _ga_FVSDNMVW46=GS1.2.1744834366.1.1.1744834719.59.0.0; __cflb=02DiuJFcgbX2zpcHdRusb7zVwg8RFD7sBirXqMh1W3gBe; _chartbeat2=.1730832657048.1745345088258.1000100000000001.BqTgZLB94n-zD9nPB3_IChcZLGbq.1; minUnifiedSessionToken10=%7B%22sessionId%22%3A%222b763fe0ad-50aa79616c-1dd3ff6a36-4caedb779e-25173818f3%22%2C%22uid%22%3A%22f1b7df8e92-3668ac3c52-fb8cef5330-fa2c063894-c31a5d8438%22%2C%22__sidts__%22%3A1745345088346%2C%22__uidts__%22%3A1745345088346%7D; _gid=GA1.2.774545763.1745345089; kndctr_A65F776A5245B01B0A490D44_AdobeOrg_identity=CiYwMTA0Nzg5MzYyMTkwODc3OTExMjY4NTAyNDI4MjgwNjQyMjUzOFIQCKOM7%2DPfMhgBKgNPUjIwA%5FAB%2DPGx9eUy; mbox=session#2ae28d6b55274f6ead247e995bf0fbba#1745346943|PC#afa588117f754338908d74c9606983e4.35_0#1808591703; _ga_N8YFCZLYSZ=GS1.1.1745346903.8.0.1745346903.60.0.205013699; _ga=GA1.2.2011063467.1744052867; _scid_r=HQdPZsywQ4FHSiDhvs3KefecC-DGmPMPebXX3Q; OptanonConsent=isGpcEnabled=0&datestamp=Tue+Apr+22+2025+11%3A35%3A03+GMT-0700+(Pacific+Daylight+Time)&version=202502.1.0&browserGpcFlag=0&isIABGlobal=false&hosts=&consentId=cb86474f-f174-4842-b601-b60b49f84ce1&interactionCount=1&isAnonUser=1&landingPath=NotLandingPage&groups=C0001%3A1%2CC0003%3A1%2CC0002%3A1%2CC0004%3A1&intType=3&geolocation=US%3BOR&AwaitingReconsent=false; _uetsid=47eb06901fa411f0b2592b094ae57f65; _uetvid=e4cd86809ba611ef903223ae709ab1c0; s_getNewRepeat=1745346943650-Repeat; s_lv=1745346943651; ttcsid_CPGTP6JC77U5SPBHH95G=1745346903787::rfaKXWZ7MOlAjGQ5GkKE.5.1745346943844; ttcsid_CBM13CRC77U963VPQL9G=1745346903948::xaVx6O2yGYfdcZn7P1JF.5.1745346943848; ttcsid_CUR2STRC77U4QKJNGKOG=1745346904000::fspMxsOgnGgbYADDeiez.5.1745346943852; ttcsid=1745346903787::fMC-I_NVUF90_WVQgR8t.5.1745346943853; AMCV_A65F776A5245B01B0A490D44%40AdobeOrg=1099438348%7CMCIDTS%7C20201%7CMCMID%7C01047893621908779112685024282806422538%7CMCAAMLH-1745951891%7C9%7CMCAAMB-1745951891%7C6G1ynYcLPuiQxYZrsz_pkqfLG9yMXBpb2zX5dvJdYQJzPXImdj0y%7CMCOPTOUT-1745354291s%7CNONE%7CMCAID%7CNONE%7CMCSYNCSOP%7C411-20197%7CvVersion%7C2.1.0; __gads=ID=a1a63c2b08cf72c0:T=1739839528:RT=1745347240:S=ALNI_Mb_S9DHPzGZbymcO8fr1YaL9So7Zw; __gpi=UID=0000104efefab578:T=1739839528:RT=1745347240:S=ALNI_MZLv3zsBnvXDr48gLk0zXT2IxY_Hg; __eoi=ID=960ec4c20fca01a6:T=1739839528:RT=1745347240:S=AA-AfjZs3iY0cg-QABdzW-WQaqo9; s_cc=true; s_sq=%5B%5BB%5D%5D; _dd_s=rum=0&expire=1745351530656'
}

def batter_request(player_id, seasons, phand):
    url = f"https://baseballsavant.mlb.com/statcast_search/csv?all=true&hfPT=&hfAB=&hfGT=R|&hfPR=&hfZ=&hfStadium=&hfBBL=&hfNewZones=&hfPull=&hfC=&hfSea={'|'.join(seasons)}|&hfSit=&player_type=pitcher&hfOuts=&hfOpponent=&pitcher_throws={phand}&batter_stands=&hfSA=&game_date_gt=&game_date_lt=&hfMo=&hfTeam=&home_road=&hfRO=&position=&hfInfield=&hfOutfield=&hfInn=&hfBBT=&batters_lookup[]={player_id}&hfFlag=&metric_1=&group_by=team-pitch-type&min_pitches=0&min_results=0&min_pas=0&sort_col=pitches&player_event_sort=api_p_release_speed&sort_order=desc&chk_stats_hits=on&chk_stats_singles=on&chk_stats_dbls=on&chk_stats_triples=on&chk_stats_hrs=on&minors=false"

    request = session.get(url)

    table = pd.read_csv(io.StringIO(request.text))
    return table

def pitcher_req(player_id, seasons):
    result = pd.DataFrame()
    for hand in ["R", "L"]:
        url = f"https://baseballsavant.mlb.com/statcast_search/csv?all=true&hfPT=&hfAB=&hfGT=R|&hfPR=&hfZ=&hfStadium=&hfBBL=&hfNewZones=&hfPull=&hfC=&hfSea={'|'.join(seasons)}|&hfSit=&player_type=pitcher&hfOuts=&hfOpponent=&pitcher_throws=&batter_stands={hand}&hfSA=&game_date_gt=&game_date_lt=&hfMo=&hfTeam=&home_road=&hfRO=&position=&hfInfield=&hfOutfield=&hfInn=&hfBBT=&hfFlag=&pitchers_lookup[]={player_id}&metric_1=&group_by=pitch-type&min_pitches=0&min_results=0&min_pas=0&sort_col=pitches&player_event_sort=api_p_release_speed&sort_order=desc&minors=false"
        request = session.get(url)

        table = pd.read_csv(io.StringIO(request.text))
        table["batter_hand"] = hand
        result = pd.concat([result, table])
    return result